(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{862:(e,t,l)=>{Promise.resolve().then(l.bind(l,4441))},4441:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>s});var a=l(3501),r=l(1673);let s=()=>{let[e,t]=(0,r.useState)(3),[s,n]=(0,r.useState)(3),[i,o]=(0,r.useState)(null),[c,d]=(0,r.useState)([]),[m,x]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),p=(0,r.useRef)(null),f=(0,r.useRef)(null),g=e=>{if(!e.type.startsWith("image/")){alert("请上传图片文件");return}o(null),d([]),h(!1);let t=new FileReader;t.onload=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.result)&&o(e.target.result)},t.readAsDataURL(e)},w=async()=>{if(i){x(!0);try{let t=await fetch(i),l=await t.blob(),a=new File([l],"image.jpg",{type:l.type}),r=new FormData;r.append("image",a),r.append("rows",e.toString()),r.append("columns",s.toString());let n=await fetch("/api/split-image",{method:"POST",body:r}),o=await n.json();if(o.error)throw Error(o.error);d(o.pieces)}catch(e){console.error("Failed to split image:",e),alert("图片切割失败，请重试")}finally{x(!1)}}},b=async(e,t)=>{try{let l=await fetch(e),a=await l.blob(),r=window.URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="piece_".concat(t+1,".png"),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}catch(e){console.error("下载失败:",e),alert("下载失败，请重试")}},j=async()=>{try{let e=new(await l.e(545).then(l.t.bind(l,2545,23))).default,t=c.map(async(t,l)=>{let a=await fetch(t),r=await a.blob();e.file("piece_".concat(l+1,".png"),r)});await Promise.all(t);let a=await e.generateAsync({type:"blob"}),r=window.URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.download="split_images.zip",document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}catch(e){console.error("打包下载失败:",e),alert("打包下载失败，请重试")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-[#0B1120] -z-10"}),(0,a.jsx)("main",{className:"min-h-screen w-full py-16 md:py-20",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 max-w-7xl",children:[(0,a.jsxs)("div",{className:"text-center mb-12 md:mb-16",children:[(0,a.jsx)("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-bold mb-4 animate-fade-in",children:(0,a.jsx)("span",{className:"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-transparent bg-clip-text bg-[size:400%] animate-gradient",children:"图片切割工具"})}),(0,a.jsx)("p",{className:"text-gray-400 text-base md:text-lg max-w-2xl mx-auto animate-fade-in-up",children:"上传一张图片，快速将其切割成网格布局，支持自定义行列数。"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 md:gap-8 mb-12 md:mb-16",children:[(0,a.jsxs)("div",{className:"relative h-[600px] bg-[#1a2234] rounded-xl overflow-hidden",children:[(0,a.jsx)("input",{ref:f,type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];l&&g(l)},id:"imageUpload"}),(0,a.jsx)("label",{htmlFor:"imageUpload",className:"absolute inset-0 flex flex-col items-center justify-center cursor-pointer",children:i?(0,a.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[(0,a.jsx)("img",{ref:p,src:i,alt:"上传的图片",className:"max-w-full max-h-full object-contain",onLoad:()=>{console.log("Image loaded"),h(!0)}},i),(()=>{var t;if(!i||!p.current||!u)return null;let l="bg-blue-500 absolute pointer-events-none",r=p.current.getBoundingClientRect(),n=null===(t=p.current.parentElement)||void 0===t?void 0:t.getBoundingClientRect();if(!n)return null;let o={left:"".concat(r.left-n.left,"px"),top:"".concat(r.top-n.top,"px"),width:"".concat(r.width,"px"),height:"".concat(r.height,"px")};return(0,a.jsxs)("div",{className:"absolute pointer-events-none",style:o,children:[Array.from({length:Math.max(0,s-1)}).map((e,t)=>(0,a.jsx)("div",{className:"".concat(l," top-0 bottom-0 w-[2px]"),style:{left:"".concat((t+1)*100/s,"%"),transform:"translateX(-50%)"}},"v-".concat(t))),Array.from({length:Math.max(0,e-1)}).map((t,r)=>(0,a.jsx)("div",{className:"".concat(l," left-0 right-0 h-[2px]"),style:{top:"".concat((r+1)*100/e,"%"),transform:"translateY(-50%)"}},"h-".concat(r)))]})})()]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-4 rounded-full bg-[#242c3e] mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,a.jsx)("p",{className:"text-gray-400",children:"点击或拖拽图片到这里上传"})]})})]}),(0,a.jsx)("div",{className:"h-[600px] bg-[#1a2234] rounded-xl flex items-center justify-center",children:(()=>{if(!i)return(0,a.jsx)("p",{className:"text-gray-400",children:"切割后的图片预览"});if(m)return(0,a.jsx)("p",{className:"text-gray-400",children:"正在处理中..."});if(c.length>0){var t,l;return(0,a.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"grid gap-[3px] bg-[#242c3e]",style:{gridTemplateColumns:"repeat(".concat(s,", 1fr)"),gridTemplateRows:"repeat(".concat(e,", 1fr)"),width:(null===(t=p.current)||void 0===t?void 0:t.width)||"100%",height:(null===(l=p.current)||void 0===l?void 0:l.height)||"100%",maxWidth:"100%",maxHeight:"100%"},children:c.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:"切片 ".concat(t+1),className:"w-full h-full object-cover"}),(0,a.jsx)("button",{onClick:()=>b(e,t),className:"absolute inset-0 flex items-center justify-center bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})]},t))})})}return(0,a.jsx)("p",{className:"text-gray-400",children:"点击切割按钮开始处理"})})()})]}),(0,a.jsx)("div",{className:"py-4 md:py-6",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4 w-full sm:w-auto",children:[(0,a.jsxs)("div",{className:"bg-[#1a2234] rounded-xl px-5 py-2.5 flex items-center gap-4 border border-[#242c3e] w-full sm:w-auto",children:[(0,a.jsx)("span",{className:"text-gray-400 font-medium min-w-[40px]",children:"行数"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-[#242c3e] rounded-lg p-1 flex-1 sm:flex-none justify-center",children:[(0,a.jsx)("button",{className:"w-8 h-8 flex items-center justify-center text-white rounded-lg hover:bg-blue-500 transition-colors",onClick:()=>t(Math.max(1,e-1)),children:"-"}),(0,a.jsx)("span",{className:"text-white min-w-[32px] text-center font-medium",children:e}),(0,a.jsx)("button",{className:"w-8 h-8 flex items-center justify-center text-white rounded-lg hover:bg-blue-500 transition-colors",onClick:()=>t(e+1),children:"+"})]})]}),(0,a.jsxs)("div",{className:"bg-[#1a2234] rounded-xl px-5 py-2.5 flex items-center gap-4 border border-[#242c3e] w-full sm:w-auto",children:[(0,a.jsx)("span",{className:"text-gray-400 font-medium min-w-[40px]",children:"列数"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 bg-[#242c3e] rounded-lg p-1 flex-1 sm:flex-none justify-center",children:[(0,a.jsx)("button",{className:"w-8 h-8 flex items-center justify-center text-white rounded-lg hover:bg-blue-500 transition-colors",onClick:()=>n(Math.max(1,s-1)),children:"-"}),(0,a.jsx)("span",{className:"text-white min-w-[32px] text-center font-medium",children:s}),(0,a.jsx)("button",{className:"w-8 h-8 flex items-center justify-center text-white rounded-lg hover:bg-blue-500 transition-colors",onClick:()=>n(s+1),children:"+"})]})]}),(0,a.jsx)("button",{className:"px-5 py-2.5 bg-[#1a2234] text-gray-400 rounded-xl hover:bg-[#242c3e] hover:text-white transition-all font-medium border border-[#242c3e] w-full sm:w-auto",onClick:()=>{t(3),n(3)},children:"重置"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full sm:w-auto",children:[(0,a.jsx)("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-medium shadow-lg shadow-blue-500/20 w-full sm:w-auto",disabled:!i||m,onClick:w,children:m?"处理中...":"切割图片"}),(0,a.jsx)("button",{className:"px-6 py-3 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-xl hover:from-red-600 hover:to-red-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-lg shadow-red-500/20 w-full sm:w-auto",onClick:()=>{o(null),d([]),h(!1),f.current&&(f.current.value="")},disabled:!i,children:"清除"})]}),c.length>0&&(0,a.jsxs)("button",{onClick:j,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all font-medium shadow-lg shadow-green-500/20 flex items-center justify-center gap-2 w-full sm:w-auto",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"打包下载"]})]})}),(0,a.jsx)("div",{className:"h-16 md:h-20"})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[822,649,358],()=>t(862)),_N_E=e.O()}]);